# 8051Clock  
## 杜邦线连接  
- P2.0-->JP26.DS  
- P2.1-->JP26.SHCP  
- P2.2-->JP26.STCP  
- P2.3-->JP22.IO  
- P3.2-->任意独立按键A  
- P3.3-->任意独立按键B  

## 操作逻辑  
默认为显示时间模式。从左到右7个小数点表示星期，最左边的表示周日，向右分别为周一、周二...周六。最右边的小数点表示是否开启整点报时功能。  

显示时间模式下，长按A键进入设置时模式，在设置时模式下，短按A键进入设置分模式，短按A键进入设置秒模式，短按A键进入设置时模式，循环往复。  

在设置时分秒模式下，短按B键使示数加一，长按B键取消更改，长按A键确认更改。  

显示时间模式下，短按B键进入显示日期模式。  

显示时器模式下，长按A键进入设置年模式，在设置年模式下，短按A键进入设置月模式，短按A键进入设置日模式，短按A键进入设置年模式，循环往复。  

在设置年月日模式下，短按B键使示数加一，长按B键使示数减一，长按A键确认更改。  

显示日期模式下，短按B键回到显示时间模式。  

注1：星期不能自主设置，由蔡勒公式计算出，公式如下：  

$$W=(Y+\left[\frac{Y}{4}\right]+\left[\frac{C}{4}\right]-2C+\left[\frac{26(M+1)}{10}\right]+D-1)\ \%\ 7$$  
公式中的符号含义如下：

- $W$：星期
- $C$：世纪数减一 (年份前两位数)
- $Y$：年(年份后两位数)
- $M$：月(M的取值范围为3至14，即在蔡勒公式中，某年的1、2月要看作上一年的13、14月来计算，比如2003 年1月1日要看作2002年的13月1日来计算)
- $D$ ：日
- $[]$：称作高斯符号，代表取整，即只要整数部份

该方法的缺陷为：只能算1582年10月4日往后的星期数。

注2：解释一下为什么在设置时间时，不能使示数减一，能取消更改，而在设置日期时，能使示数减一，不能取消更改。原因(1)：只有两个按键，每个按键只有两种触发方式，所以只能有四种操作，确认设置操作、加一操作、切换设置对象操作就占了三个，所以取消设置操作和减一操作只能选其一。原因(2)：在设置时间或者设置日期模式下，示数是暂停的，但时间是时刻在更改的，所以如果不小心进入了设置时间模式下，即使立刻确认，也会延迟几秒，所以设置时间模式下，取消操作是必须的；而在设置时间模式下，计数最大值仅为60，即使不小心按多了，多按几下回到0也不太麻烦（其实还是有点麻烦的，但不大），所以设置时间模式下，减一操作不是必须的。原因(3)：但日期不是时刻更改的，即使不小心进入了设置日期模式，立即确认后不会有影响，所以设置日期模式下，取消操作不是必须的；而在设置日期模式下，年的最大值为9999，要是不小心按多了，还确认了，这时要想减少，就只能按到9999，然后回到0了，这不得按到死，所以设置日期模式下，减一操作是必须的。综上所述，给设置时间模式取消操作，给设置日期模式减一操作。  

显示时间模式下，长按B键开启/关闭整点报时功能。  

显示时间模式下，短按A键进入秒表模式，秒表模式下，短按B键开始/暂停计时，在暂停计时状态下，长按B键清零，清零后短按A键进入闹钟模式。  

闹钟模式下，短按B键开启/关闭闹钟，长按A键进入设置闹钟时模式，在设置闹钟时模式下，短按A键进入设置闹钟分模式，短按A键进入设置闹钟时模式，短按A键计入设置闹钟周日模式，短按A键计入设置闹钟周一模式...短按A键计入设置闹钟周六模式，短按A键计入设置闹钟时模式，循环往复。  

在设置闹钟时分以及星期模式下，短按B键使闹钟加一，长按A键确认更改，长按B键取消更改。  
